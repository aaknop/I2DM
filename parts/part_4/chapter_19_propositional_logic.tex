\chapter{Propositional Logic}
\label{chapter:propositional-logic}

This part, as it follows fromt the title, is devoted to mathematical logic,
a mathematical approach to a branch of philosophy called logic. Logic studies
reasoning and mathematical logic studies mathematical reasoning. As we have
mentioned in \Cref{chapter:proofs} proofs in mathematics consists of
\emph{sentences} of a certain structure that are connected by implications.
In addition,  as we discussed in \Cref{chapter:predicates}, we can build larger
sentences from smaller ones using connectives.

Note that in real life the sentences are written using common English wich is
amgious and therefore hard for analisis.
So to create a formal description of mathematics we need to create an
artificial formal language for mathematics.

First (\Cref{chapter:propositional-logic}) we will define a language for
propositional (sentential) logic; i.e. the logic which deals only with
propositions. Later (\Cref{chapter:predicate-logic}) we extend it to a logic
which also takes properties of individuals into account.


The process of formalization of propositional logic consists of two main parts:
\begin{itemize}
  \item present a formal language,
  \item specify a procedure for obtaining valid or true propositions.
\end{itemize}

\section{Propositional Formulas}

\marginurl{%
  Propositional Formulas:\\\noindent
  Introduction to Mathematical Logic \#1
}{youtu.be/X0797bVFf3Y}

Statements in  propositional logic are either some independant atomic
statements, or are formed from the atomic one using connectives.

In other words, statements in propositional logic can be defined using
propositional formulas (also known as sentential formulas or Boolean formulas).
\begin{definition}
  We say that a finite sequence $\phi$ of elements of the set
  $V \cup \set{\lnot, \lor, \land, \limplies, \text{``(''}, \text{``)''}}$
  is a propositional formula on the variables from $V$ if
  \begin{itemize}
    \item either $\phi$ is equal to $x$ for some $x \in V$,
    \item or $\phi$ is equal to $(\psi_1 \land \psi_2)$, or
      $(\psi_1 \lor \psi_2)$, or $(\psi_1 \limplies \psi_2)$,\footnote{%
        The symbol $\limplies$ is used to denote the implication.
        Due to historical reasons the standard symbol $\implies$ is rarerely
        used as a connective in mathematical logic; hence, we will use
        $\limplies$ instead of $\implies$ in this part of the book.
        It is important to note that, sometimes the symbol $\supset$ is also
        used instead of $\implies$.
      }
      where $\psi_1$ and $\psi_2$ are propositional formulas on the variables
      from $V$,
    \item or $\phi$ is equal to $\lnot \psi$, where $\psi$ is a propositional
      formula on the variables from $V$.
  \end{itemize}

  We denote the set of all propositional formulas by $\prop{V}$.
\end{definition}

For example, $((x_1 \lor \lnot x_2) \land x_3)$ is a propositional formula on
the variables from $\set{x_1, x_2, x_3}$ (we also say that it is a formula on
$x_1$, $x_2$, $x_3$).

\begin{exercise}
  Write the definition of propositional formulas using the terminology
  ``the set generated by \dots from \dots'' (see \Cref{chapter:functions}).
\end{exercise}

Hereafter when naming formulas, we will not mention explicitly all the
parenthesis. To establish a more compact notation, we adopt the following
conventions.
\begin{itemize}
  \item The outermost parentheses do not need to be explicitly mentioned; e.g.,
    we write ``$A \land B$'' to refer to $(A \land B)$.
  \item The negation symbol applies to as little as possible.
    For example, $\lnot A \land B$ denotes $(\lnot A) \land B$;
    i.e., $((\lnot A) \land B)$. Which is not the same as
    $(\lnot (A \land B))$.
  \item The conjunction and disjunction symbols apply to as little as possible,
    given that convention 2 is to be observed. For example,
    $A \land B \limplies \lnot C \lor D$ is
    $((A \land B) \limplies ((\lnot C) \lor D))$.
  \item Where one connective symbol is used repeatedly, grouping is to the
    right: $A \land B \land C$ is $A \land (B \land C)$,
    $A \limplies B \limplies C$ is $A \limplies (B \limplies C)$.
\end{itemize}

Interpreting propositional logic is not difficult since the
considered entities have a simple structure. The propositions are built up from
rough blocks by adding connectives.
The simplest parts (atoms) are of the form ``cows are animals'', ``Earth is flat'', ``$2 \times 2 = 2$'', which are simply true or false.
We extend this assignment of truth values to composite propositions,
by reflection on the meaning of the logical connectives.

\begin{definition}
  A function $v : \prop{V} \to \set{\ltrue, \lfalse}$ is a valuation if
  \begin{itemize}
    \item $v(\lnot \psi) = \lnot v(\psi)$,
    \item $v(\psi_1 \land \psi_2) = v(\psi_1) \land v(\psi_2)$,
    \item $v(\psi_1 \lor \psi_2) = v(\psi_1) \lor v(\psi_2)$, and
    \item $v(\psi_1 \limplies \psi_2) = v(\psi_1) \limplies v(\psi_2)$.
  \end{itemize}
\end{definition}

We may note that all the valuations are actualy can be defined by the values
of variables.
\begin{theorem}
  Let $\rho : V \to \set{\ltrue, \lfalse}$ be a function (we say that $\rho$ is
  a propositional assignement). Then there is a unique valuation
  $\substitute{\cdot}{\rho} : \prop{V} \to \set{\ltrue, \lfalse}$ such that
  $\substitute{x}{\rho} = \rho(x)$ for any $x \in V$.
\end{theorem}

Since any valuation can be defined by the values assigned to variables, we need
to introduce the following notation.
If $V = \set{x_1, \dots, x_n}$ and $v_1, \dots, v_n \in \set{\ltrue, \lfalse}$,
then $\substitute{\cdot}{x_1 = v_1, \dots, x_n = v_n}$ denotes the valuation
such that $\substitute{x_i}{x_1 = v_1, \dots, x_n = v_n} = v_i$ for each
$i \in \range{n}$.


For example, the value of a formula $(x_1 \land \lnot x_2) \lor x_3$ when
$\ltrue$ is substituted as the value of $x_1$,
$\ltrue$ is substituted as the value of $x_2$,
and $\lfalse$ is substituted as the value of $x_3$ is equal to
$(\ltrue \land \lfalse) \lor \lfalse = \lfalse$.

Note that if $\phi$ is a formula on the variables from $V$ it does not mean that
all the variables from $V$ have to be used.
For example, $x_1$ is a formula on the variables from $\set{x_1, x_2}$; however,
$x_2$ is not used in the formula.

\begin{exercise}
  Define (using structural induction) the set of all the variables that are
  used in a propositional formula $\phi$ on variables from a set $V$.
\end{exercise}

Let $\phi$ be a formula $\phi$ on the variables from a set $V$. The definition
of a value of a formula requeres us to specify all the values of all the
variables from $V$. However, the following theorem shows that in
fact we need to specify only the variables that are actually used in $\phi$.
\begin{theorem}
  Let $\phi$ be a formula $\phi$ on the variables from a set $V$,
  and $U$ be the set of the variables used in $\phi$.

  Consider $\rho_1, \rho_2 : V \to \set{\ltrue, \lfalse}$ such that
  $\rho_1(x) = \rho_2(x)$ for any $x \in U$.
  Then $\substitute{\phi}{\rho_1} = \substitute{\phi}{\rho_2}$.
\end{theorem}
\begin{proof}
  We prove the statement using the structural induction.
  \begin{description}
    \item[(base case)] Let $\phi = x$ for some $x \in V$.
      Note that $x \in U$ and $\substitute{\phi}{\rho_1} = \rho_1(x) =
      \rho_2(x) = \substitute{\phi}{\rho_2}$.
    \item[(induction step)] We need to consider the following three cases.
      \begin{itemize}
        \item Let $\phi$ be equal to $\psi_1 \land \psi_2$ such that
          $\substitute{\psi_1}{\rho_1} = \substitute{\psi_1}{\rho_2}$ and
          $\substitute{\psi_1}{\rho_2} = \substitute{\psi_2}{\rho_2}$.
          In this case,
          $\substitute{\phi}{\rho_1} =
            (\substitute{\psi_1}{\rho_1} \land \substitute{\psi_2}{\rho_1} )=
            (\substitute{\psi_1}{\rho_2} \land \substitute{\psi_2}{\rho_2}) =
            \substitute{\phi}{\rho_2}$.
        \item Let $\phi$ be equal to $\psi_1 \lor \psi_2$ such that
          $\substitute{\psi_1}{\rho_1} = \substitute{\psi_1}{\rho_2}$ and
          $\substitute{\psi_1}{\rho_2} = \substitute{\psi_2}{\rho_2}$.
          In this case,
          $\substitute{\phi}{\rho_1} =
            (\substitute{\psi_1}{\rho_1} \lor \substitute{\psi_2}{\rho_1}) =
            (\substitute{\psi_1}{\rho_2} \lor \substitute{\psi_2}{\rho_2}) =
            \substitute{\phi}{\rho_2}$.
        \item Let $\phi$ be equal to $\psi_1 \limplies \psi_2$ such that
          $\substitute{\psi_1}{\rho_1} = \substitute{\psi_1}{\rho_2}$ and
          $\substitute{\psi_1}{\rho_2} = \substitute{\psi_2}{\rho_2}$.
          In this case,
          $\substitute{\phi}{\rho_1} =
            (\substitute{\psi_1}{\rho_1} \limplies \substitute{\psi_2}{\rho_1}) =
            (\substitute{\psi_1}{\rho_2} \limplies \substitute{\psi_2}{\rho_2}) =
            \substitute{\phi}{\rho_2}$.
      \end{itemize}
  \end{description}
\end{proof}

\begin{exercise}
  Let $\phi_1$, $\phi_2$, and $\phi_3$ be propositional formulas on the
  variables from a set $V$. Show that for any propositional assignement
  $\rho$ to $V$,
  $\substitute{\phi_1 \land (\phi_2 \land \phi_3)}{\rho} =
   \substitute{(\phi_1 \land \phi_2) \land \phi_3}{\rho}$.
\end{exercise}

\section{Conjunctive and Disjuctive Normal Form}

Let $\phi_1$, \dots, $\phi_n$ be some propositional formulas. Then
\begin{itemize}
  \item $\bigland_{i = 1}^1 \phi_i = \phi_1$ and
    $\biglor_{i = 1}^1 \phi_i = \phi_1$, and
  \item $\bigland_{i = 1}^{k + 1} \phi_i =
    (\bigland_{i = 1}^{k} \phi_i) \land \phi_{k + 1}$ and
    $\biglor_{i = 1}^{k + 1} \phi_i =
      (\biglor_{i = 1}^{k} \phi_i) \lor \phi_{k + 1}$.
\end{itemize}
In other words $\bigland_{i = 1}^n \phi_i$ and $\biglor_{i = 1}^n \phi_i$
denotes the conjunction of the formulas $\phi_1$, \dots, $\phi_n$, and
$\biglor_{i = 1}^n \phi_i$ denotes the disjunction of them.

\begin{exercise}
  Let $\phi_1$, \dots, $\phi_n$, $\psi_1$, \dots, $\psi_m$, $\chi_1$, \dots,
  $\chi_{n + m}$ be some propositional formulas on the variables from $V$
  such that $\chi_i = \phi_i$ for $i \le n$ and $\chi_i = \psi_{i - n}$ for
  $n < i \le m$. Show that
  $\substitute{\left(\bigland_{i = 1}^n \phi_i\right) \land
    \left(\bigland_{i = 1}^n \psi_i\right)}{\rho} =
  \substitute{\left(\bigland_{i = 1}^{n + m} \chi_i\right)}{\rho}$
  for any propositional assignement $\rho$ to $V$.
\end{exercise}


Using this notation we may show that propositional formulas can represent all
the Boolean functions (functions from $\set{\ltrue, \lfalse}^n$ to
$\set{\ltrue, \lfalse}$).
\begin{theorem}
\label{theorem:function-to-formula}
  For any function $f : \set{\ltrue, \lfalse}^n \to
  \set{\ltrue, \lfalse}$ there is a
  formula $\phi$ on the variables $x_1$, \dots, $x_n$ such that
  $\substitute{\phi}{x_1 = v_1, \dots, x_n = v_n} = f(v_1, \dots, v_n)$ for all
  $v_1, \dots, v_n \in \set{\ltrue, \lfalse}$.
\end{theorem}

Let $u \in \set{\ltrue, \lfalse}$ and $x \in V$. Then $x^u$ denotes a
formula on the variables from $V$ such that $x^u = x$ if $u = \ltrue$ and
$x^u = \lnot x$ if $u = \lfalse$. Note that $\substitute{x^u}{\rho} = \ltrue$
iff $\rho(x) = u$, for any propositional assignement $\rho$ to $V$.
Indeed, if $u = \ltrue$, then $x^u = x$ and
$\ltrue = \substitute{x^u}{\rho} = \substitute{x}{\rho} = \rho(x)$ so
$\rho(x) = \ltrue = u$;
if $u = \lfalse$, then $x^u = \lnot x$ and
$\ltrue = \substitute{x^u}{\rho} = \substitute{\left(\lnot x\right)}{\rho} =
\lnot \rho(x)$ so $\rho(x) = \lfalse = u$.

\begin{exercise}
  Let $\phi_1$, \dots, $\phi_k$ are propositional formulas
  on the variables from $V$.
  \begin{itemize}
    \item Show that
      $\substitute{\left(\biglor_{i = 1}^k \phi_i\right)}{\rho} = \ltrue$ iff
      $\substitute{\phi}{\rho} = \ltrue$ for some $i \in \range{k}$.
    \item Show that
      $\substitute{\left(\bigland_{i = 1}^k \phi_i\right)}{\rho} = \ltrue$ iff
      $\substitute{\phi}{\rho} = \ltrue$ for all $i \in \range{k}$.
  \end{itemize}
\end{exercise}

Using this observation and the exercise we can
prove~\Cref{theorem:function-to-formula}.
\begin{proof}
  Let $S = \set[f(u_1, \dots, u_n) = \ltrue]{(u_1, \dots, u_n) \in
    \set{\ltrue, \lfalse}^n}$.
  Assume that
  $S = \set{(u_{1, 1}, \dots, u_{1, n}), \dots, (u_{k, 1}, \dots, u_{k, n})}$.
  By the previous observations
  \[
    \substitute{
      \left(
        \biglor_{i = 1}^k
          \bigland_{j = 1}^n x_j^{u_{i, j}}
      \right)
    }{x_1 = v_1, \dots, x_n = v_n}
    =
    f(v_1, \dots, v_n)
  \]
  for all $v_1, \dots, v_n \in \set{\ltrue, \lfalse}$.
  (Note that we have not considered the case when $S = \emptyset$, in this
  case $f$ is a constant $\lfalse$ function and it is equal to
  $x_1 \land \lnot x_1$.)
\end{proof}

One may notice that the formulas we constructed have very specific form,
such a form is called disjunctive normal form (DNF).
\begin{definition}
  We say that a propositional formula $\lambda$ on the variables from $V$
  is a \emph{literal} if it is equal to $x$ or to $\lnot x$ for some
  $x \in V$.

  We say that a propositional formula $\psi$ on the variables from $V$ is
  a \emph{term} if $\psi$ is equal to $\bigland_{i = 1}^\ell \lambda_i$, where $\lambda_1$, \dots, $\lambda_\ell$ are literals.

  Finally, we say that a propositional formula $\phi$ on the variables from
  $V$ is in \emph{disjunctive normal form} (DNF) if $\phi$ is equal to
  $\biglor_{i = 1}^k \psi_i$, where $\psi_1$, \dots, $\psi_k$ are
  terms.
\end{definition}

However, there is nothing special in this order of operations (disjunction of
conjunctions). So we can define conjunctive normal form (CNF) too.
\begin{definition}
  We say that a propositional formula $\psi$ on the variables from $V$ is
  a \emph{clause} if $\psi$ is equal to $\biglor_{i = 1}^\ell \lambda_i$, where
  $\lambda_1$, \dots, $\lambda_\ell$ are literals.

  Finally, we say that a propositional formula $\phi$ on the variables from
  $V$ is in \emph{conjunctive normal form} (DNF) if $\phi$ is equal to
  $\bigland_{i = 1}^k \psi_i$, where $\psi_1$, \dots, $\psi_k$ are
  clauses.
\end{definition}

Using the following simple trick we can prove that any function
has a representation in CNF. First, we define a function
$g(x_1, \dots, x_n) = \lnot f(x_1, \dots, x_n)$. Secondly, we may notice that
\[
  \substitute{
    \left(
      \lnot
      \left(
        \bigland_{i = 1}^k \biglor_{j = 1}^n \phi_{i, j}
      \right)
    \right)
  }{x_1 = v_1, \dots, x_n = v_n}
  =
  \substitute{
    \left(
      \biglor_{i = 1}^k \bigland_{j = 1}^n \lnot \phi_{i, j}
    \right)
  }{x_1 = v_1, \dots, x_n = v_n}
\]
for all $v_1, \dots, v_n \in \set{\ltrue, \lfalse}$
% THE REFERENCE TO THE EXERCISE
(see Exercise 15.7). Therefore the negation
of a formula in DNF can be easily tranformed into a formula in CNF.
Finally, we know that the function
$g$ has a representation in DNF, which implies that $f$ has a representation
in CNF.

\section{Truth Tables}
\label{section:truth-tables}
\marginurl{%
  Proofs Using Truth Tables:\\\noindent
  Introduction to Mathematical Logic \#2
}{youtu.be/DOAxnmScpPc}

Typical theorem in mathematics have the following template:
``if some statements are true, then some statement is also true''.
In propositional logic statements are described using propositional formulas.
So our goal is to present a way to describe proofs of results that looks like:
if $\phi_1$, \dots, $\phi_k$ are true, then $\psi$ is also true.

This section discusses the method which is based on truth tables (we discussed
it before in \Cref{chapter:predicates}).

We start from an example similar to
the proof gaven in the beginning of the first chapter. Assume that we know
that if $x$ is a real number such that $x < -2$ or $x > 2$, then $x^2 > 4$. We
can derive that if $\lnot (x^2 > 4)$, then $\lnot (x < -2)$ and $\lnot (x > 2)$.

In order to emphasize the logical structure of the argument let us denote
the statement $x > 2$ by $p$, the statement $x < -2$ by $q$, and the statement
$x^2 > 4$ by $r$. In this case the argument is as follows:
if $(p \lor q) \limplies r$ is true, then
$\lnot r \limplies (\lnot p \land \lnot q)$ is true as well.

The simplest way to explain why this argument is true is to use
a truth table.
\begin{center}
    \begin{tabular}{l l l l l}
        \toprule
        $p$ & $q$ & $r$ & $(p \lor q) \limplies r$ &
        $\lnot r \limplies (\lnot p \land \lnot q)$ \\
        \midrule
        T & T & T & T & T \\
        T & T & F & F & F \\
        T & F & T & T & T \\
        T & F & F & F & F \\
        F & T & T & T & T \\
        F & T & F & F & F \\
        F & F & T & T & T \\
        F & F & F & T & T \\
        \bottomrule
    \end{tabular}
\end{center}
Note that each line where $(p \lor q) \limplies r$ is true has
$\lnot r \limplies (\lnot p \land \lnot q)$ true as well. So we proved that
the argument is indeed correct.

We may also note that we showed that
\[
  \bigl((p \lor q) \limplies r\bigr) \iff
  \bigl(\lnot r \limplies (\lnot p \land \lnot q) \bigr)
\]
is always true (we say that this propositional formula is a
\emph{tautology}). A generalization of this saying the if $p \limplies q$ is
true, then $\lnot q \limplies \lnot p$ is also true is called the
\emph{contraposition} argument.

Let us now consider another argument. If we know that Joe was a good boy and we
know that if Joe is a good boy, then Santa gives a present to Joe. We may
conclude that Santa gives a present to Joe. We can similarly to the previous
example write this argument using variables and connectives.
If we know that $p$ and $p \limplies q$, we may conclude that $q$ is true.
\begin{exercise}
  Show that $(p \land (p \limplies q)) \limplies q$ is a tautology.
\end{exercise}
Such an argument is called \emph{modus ponens}.

A notion connected to being a tautology is the notion of being satisfiable.
We say that a formula (a set of formulas) is \emph{satisfiable} iff there
is a substitution to the variables such that the value of the formula is true
(the values of all the formulas are true). Note that a formula is not
satisfiable (the formula is \emph{unsatisfiable}) iff its negation is
a tautology. Therefore, using truth tables one may check whether a formula
is satisfiable or not.\footnote{%
  Note that the procedure is awfully not efficient since if the formula
  uses $n$ variables we need to do $2^n$ operations. Unfortunately,
  we do not know anything that always works better since
  satisfiability problem (the problem of determining whether a given formula is
  satisfiable or not) is NP complete.
}

\section{Semantic Implication}
As we mentioned at the beginning of the previous section, most of the
statements in mathematics are in the form
``if some statements are true, then some statement is also true'';
this type of statements can be described using the notion of semantic
implication. We say that a set $\Sigma$ of propositional formulas with
variables from a set $V$ \emph{semantically implies} a propositional formula
$\phi$ with variables from the set $V$ (we denote it by $\Sigma \models \phi$)
iff whenever all the formulas from $\Sigma$ are true under some propositional
assignement to $V$, the formula $\phi$ is also true under this propositional
assignement; i.e.,
$\Sigma \models \phi$ iff for any $\rho : V \to \set{\ltrue, \lfalse}$,
$\substitute{\phi}{\rho} = \ltrue$ provided that
$\substitute{\psi}{\rho} = \ltrue$ for all $\psi \in \Sigma$.
(Note that the set $\Sigma$ may be infinite.)

In the previous section we explained that if we have a finite set $\Sigma$,
then it is possible to check whether a formula $\phi$ is semantically implied
by $\Sigma$. Let us try to find out whether we can do the same for infinite
sets $\Sigma$.

Partial answer to this question is given by the following theorem.
\begin{theorem}[compactness theorem]
  A set $\Sigma$ of propositional formulas is satisfiable iff every finite
  subset is satisfiable.
\end{theorem}
\begin{proof}
  We say that a set is \emph{finitely satisfiable} if every finite subset
  is satisfiable.


  Let us enumerate all the propositional formulas $\alpha_1$, $\alpha_2$, \dots.
  We define a family of sets $\Delta_1$, \dots, $\Delta_n$, \dots
  such that $\Delta_1 = \Sigma$ and
  \[
    \Delta_{n + 1} =
    \begin{cases}
      \Delta_n \cup \set{\alpha_{n + 1}} & \text{if }
        \Delta_n \cup \set{\alpha_{n + 1}} \text{is finitely satisfiable,} \\
      \Delta_n \cup \set{\lnot \alpha_{n + 1}} & \text{otherwise.}
    \end{cases}
  \]
  Note that all the $\Delta_n$ are finitely satisfiable.

  Let $\Delta = \cup_{n \in \N} \Delta_n$. It is clear that $\Delta$ is
  finitely satisfiable and for any propositional formula $\alpha$,
  either $\alpha$ or $\lnot \alpha$ belongs to $\Delta$.

  Let us consider a substitution $v_1$, \dots, $v_n$, \dots to the variables
  $x_1$, \dots, $x_n$, \dots such that $v_i = \ltrue$ iff the formula $x_i$
  belongs to $\Delta$. We may note that this substitution satisfies any
  formula $\phi \in \Delta$.
\end{proof}

Using this theorem, we can show that any implication of an infinite set is
actually an implication of a finite subset of it.
\begin{corollary}
  Let $\Sigma$ be a set of propositional formulas over the variables
  $x_1$, $x_2$, \dots, $x_n$, \dots, and $\phi$ be a propositional formula
  over the same set. If $\Sigma \models \phi$, then there is a finite
  $\Sigma' \subseteq \Sigma$ such that $\Sigma' \models \phi$.
\end{corollary}
\begin{proof}
  Note that $\Sigma \not\models \phi$ iff $\Sigma \cup \set{\phi}$ is
  satisfiable.

  Let us now assume that for any finite $\Sigma' \subseteq \Sigma$,
  $\Sigma' \not\models \phi$. This implies that $\Sigma' \cup \set{\phi}$
  is satisfiable for all finite $\Sigma'$. Therefore, $\Sigma \cup \set{\phi}$
  is satisfiable, which is a contradiction to the assumption that
  $\Sigma \models \phi$.
\end{proof}

Therefore if we wish to check whether a formula $\phi$ is semantically implied
by $\Sigma$, we just need to brute-force all the finite subsets of $\Sigma$ and
check whether they semantically imply $\phi$. By the previous argument, if
$\phi$ is implied by $\Sigma$, this procedure reports ``yes'' at some point,
and in the opposite case it will work infinitely long.

\section{Natural Deduction}

\marginurl{%
  Natural Deduction:\\\noindent
  Introduction to Mathematical Logic \#3
}{youtu.be/PfVafyptFtM}

The problem of the method discussed in \Cref{section:truth-tables} is that we
need to consider \textbf{all} possible values of the variables. Let us now
consider a more complicated example. Imagine that we know that $\lnot q$,
$p \limplies q$. Using the contraposition argument and modus ponens we may derive
$\lnot p$. Indeed, by contraposition we may conclude that
$\lnot q \limplies \lnot p$ and modus ponens implies that $\lnot p$ is true since
$\lnot q$ is true.

In other words, we can combine several tautologies to prove another tautology.
Apparently it is enough to fix some small number of tautologies to derive all
other tautologies, we call these tautologies ``rules''. There are several ways
to write such proofs, we are going to use Fitch notation for natural deduction.
In this notation any proof is written in several rows, each row in a Fitch-style
proof is either:
\begin{itemize}
  \item an assumption or subproof assumption.
  \item a sentence justified by the citation of
    \begin{enumerate*}[label=(\roman*)]
      \item a rule of inference and
      \item the prior line or lines of the proof that license that rule.
    \end{enumerate*}
\end{itemize}
We say that there is a natural deduction derivation of $\phi$ from $\psi_1$,
\dots, $\psi_k$. If there is a Fitch-style proof starting with the assumptions
$\psi_1$, \dots, $\psi_k$, and finishes with the formula $\phi$.
Using this scheme we may write the argument we just mentioned as follows.

\noindent $
  \begin{nd}
    \hypo {1} {\lnot q}
    \hypo {2} {p \limplies q}
    \have {3} {\lnot q \limplies \lnot p} \by{contraposition}{2}
    \have {4} {\lnot p} \by{modus ponens}{1, 3}
  \end{nd}
$

\noindent In the rest of the section we are going to list all the rules we use.

\paragraph{Conjunctions.}
In order to introduce a conjunction we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A}
    \have [n] {3} {B}
    \have [~] {5} {A \land B} \ai{1, 3}
  \end{nd}
\]
This rule corresponds to the tautology $(A \land B) \limplies (A \land B)$.

In order to eliminate conjunctions we can use the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {A \land B}
      \have [~] {3} {A} \ae{1}
    \end{nd}$
    &
    $\begin{nd}
      \have [m] {1} {A \land B}
      \have [~] {3} {B} \ae{1}
    \end{nd}$
  \end{tabular}
\end{center}
These rules correspond to the tautologies $(A \land B) \limplies A$ and
$(A \land B) \limplies B$.

\paragraph{Disjuctions.}
In order to introduce a disjunction we can use the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {A}
      \have [~] {3} {A \lor B} \oi{1}
    \end{nd}$
    &
    $\begin{nd}
      \have [m] {1} {A}
      \have [~] {3} {B \lor A} \oi{1}
    \end{nd}$
  \end{tabular}
\end{center}
These rules correspond to the tautologies $A \limplies (A \lor B)$ and
$A \limplies (B \lor A)$.

In order to eliminate a disjunction we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A \lor B}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {C}
    \close
    \open
      \hypo [k] {6} {B}
      \have[l] {8} {C}
    \close
    \have[~] {9} {C} \oe{1, 3-5, 6-8}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( (A \lor B) \land (A \limplies C) \land (B \limplies C) \bigr)
\limplies C$.

\paragraph{Implications.}
In order to introduce an implication we can use the following two rules.
\[
  \begin{nd}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {B}
    \close
    \have[~] {9} {A \limplies B} \ii{3-5}
  \end{nd}
\]
This rule corresponds to the tautology
$(A \limplies B) \limplies (A \limplies B)$.

In order to eliminate an implication we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A \limplies B}
    \have [n] {2} {A}
    \have[~] {9} {B} \ie{1, 2}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( (A \limplies B) \land A \bigr)
\limplies B$.

\paragraph{Negations.}
In order to introduce a negation we can use the following two rules ($\perp$ is
a special symbol representing a false statement).
\[
  \begin{nd}
    \open
      \hypo [i] {3} {A}
      \have[j] {5} {\perp}
    \close
    \have[~] {9} {\lnot A} \ni{3-5}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( A \limplies \perp \bigr)
\limplies \lnot A$.

In order to eliminate a negation we can use the following rule.
\[
  \begin{nd}
    \have [m] {1} {A}
    \have [n] {2} {\lnot A}
    \have[~] {9} {\perp} \ne{1, 2}
  \end{nd}
\]
This rule corresponds to the tautology
$\bigl( A \land \lnot A \bigr)
\limplies \perp$.

\paragraph{Truths and falsities.}
Additionally, we have the following two rules.
\begin{center}
  \begin{tabular}{c c}
    $\begin{nd}
      \have [m] {1} {\perp}
      \have [~] {3} {A} \be{1}
    \end{nd}$
    &
    $\begin{nd}
      \open
        \hypo [i] {3} {\lnot A}
        \have[j] {5} {\perp}
      \close
      \have[~] {9} {A} \by{IP}{3, 5}
    \end{nd}$
  \end{tabular}
\end{center}

\marginurl{%
  An online tool to check natural deduction proofs
}{proofs.openlogicproject.org/}

\begin{exercise}
  Check that all the tautologies we mentioned are indeed tautologies.
\end{exercise}

\section{Examples of Derivations}
In this section we give several derivations using the rules we just introduced.

First, we prove that if we know that $A \limplies \lnot A$ we can derive that
$\lnot A$.

\noindent $
  \begin{nd}
    \hypo {1} {A \limplies \lnot A}
    \open
      \hypo {2} {A}
      \have {3} {\lnot A} \ie{1, 2}
      \have {4} {\perp} \ne{2, 3}
    \close
    \have {5} {\lnot A} \ni{2-4}
  \end{nd}
$

Another statement we are going to prove is that if
$A \limplies (A \land \lnot A)$ is true, then $\lnot A$ is also true.

\noindent $
  \begin{nd}
    \hypo {1} {A \limplies (A \land \lnot A)}
    \open
      \hypo {2} {A}
      \have {3} {A \land \lnot A} \ie{1, 2}
      \have {4} {\lnot A} \ae{3}
      \have {5} {\perp} \ne{2, 4}
    \close
    \have {6} {\lnot A} \ni{2-5}
  \end{nd}
$

A bit more complicated is the proof of the law of excluded middle:
$A \lor \lnot A$.

\noindent $
  \begin{nd}
    \hypo {1} {}
    \open
      \hypo {2} {\lnot (A \lor \lnot A)}
      \open
        \hypo {3} {A}
        \have {4} {A \lor \lnot A} \oi{3}
        \have {5} {\perp} \ne{2, 4}
      \close
      \have {6} {\lnot A} \ni{3-5}
      \have {7} {A \lor \lnot A} \oi{6}
      \have {8} {\perp} \ne{2, 8}
    \close
    \have {9} {A \lor \lnot A} \by{IP}{2-8}
  \end{nd}
$

\section{Soundness and Completeness}
\marginurl{%
  Soundness and Completeness:\\\noindent
  Introduction to Mathematical Logic \#4
}{youtu.be/9Utsppn-M_I}
The most important properties of the natural deduction are the following two
theorems.

\begin{theorem}[completeness of natural deductions]
  Let $\phi$ be a propositional formula. If $\phi$ is a tautology, then
  there is a proof of $\phi$. Moreover if $\Sigma$ is a finite set of
  propositional formulas and $\Sigma \models \phi$, then there is a
  derivation of $\phi$ from $\Sigma$.
\end{theorem}

\begin{theorem}[soundness of natural deductions]
  Let $\phi$ be a propositional formula. If there is a proof of $\phi$, then
  $\phi$ is a tautology. Moreover if $\Sigma$ is a finite set of
  propositional formulas and there is a derivation of $\phi$ from $\Sigma$,
  then $\Sigma \models \phi$.
\end{theorem}


Proofs of these two theorems are not that difficult but very technical. So
prove these statements on examples to at least illustrate them.

\paragraph{Completeness of natural deductions.}
Proofs of this statement exploit the following idea: if a propositional formula
is a tautology, then we can verify this statement using the truth table. So
the proof simply brute-forces all the values of the variables of a formula and
checks that the formula is indeed true.
Consider a tautology $(\lnot A \land \lnot B) \limplies \lnot (A \lor B)$.
The proof of this tautology is as follows.

First we derive $A \lor \lnot A$ and $B \lor \lnot B$, and we use these two
formulas to consider cases using the elimination of disjunction.

\noindent$
\begin{nd}
  \hypo {1} {}
  \have {2} {A \lor \lnot A} \by{the law of excluded middle}{}
  \have {3} {B \lor \lnot B} \by{the law of excluded middle}{}
\end{nd}
$


\noindent After that, we consider the case when $A$ and $B$ are both true. Note
that the assumption of the implication is false in this case. Thus, we just need
to assume $\lnot A \land \lnot B$, derive the contradiction, and derive
$\lnot (A \lor B)$.

\noindent$
\begin{ndresume}
  \open
    \hypo {4} {A}
    \open
      \hypo {5} {B}
      \open
        \hypo {6} {\lnot A \land \lnot B}
        \have {7} {\lnot A} \ae{6}
        \have {8} {\perp} \ne{4, 7}
        \have {9} {\lnot (A \lor B)} \be{8}
      \close
      \have {10} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \ii{6-9}
    \close
\end{ndresume}
$


\noindent After that, we consider the case when $A$ is true but and $B$ is
false. In this case, the assumption of the implication is also false; thus, the
proof is the same as in the previous case.

\noindent$
\begin{ndresume}
    \open
      \hypo {11} {\lnot B}
      \open
        \hypo {12} {\lnot A \land \lnot B}
        \have {13} {\lnot A} \ae{12}
        \have {14} {\perp} \ne{4, 13}
        \have {15} {\lnot (A \lor B)} \be{14}
      \close
      \have {16} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \ii{6-9}
    \close
    \have {17} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \oe{2, 5-10, 11-16}
  \close
\end{ndresume}
$

\noindent The third case is when $A$ is false and $B$ is
true. In this case the assumption of the implication is false again, thus the
proof is the same as in the previous two cases.

\noindent$
\begin{ndresume}
  \open
    \hypo {18} {\lnot A}
    \open
      \hypo {19} {B}
      \open
        \hypo {20} {\lnot A \land \lnot B}
        \have {21} {\lnot B} \ae{20}
        \have {22} {\perp} \ne{19, 22}
        \have {23} {\lnot (A \lor B)} \be{22}
      \close
      \have {24} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \ii{20-23}
    \close
\end{ndresume}
$

\noindent Finally, we consider the case when $A$ and $B$ are false. In this
case the assumption of the implication is true, and since the formula is a
tautology and $\lnot A \land \lnot B$ is true, we know that $\lnot (A \lor B)$
is also true. Assume that $A \lor B$ is true and note that this is impossible.
Thus using introduction of the negation we can prove the statement.

\noindent$
\begin{ndresume}
    \open
      \hypo {25} {\lnot B}
      \open
        \hypo {26} {\lnot A \land \lnot B}
        \open
          \hypo {27} {A \lor B}
          \open
            \hypo {28} {A}
            \have {29} {\perp} \ne{18, 28}
          \close
          \open
            \hypo {30} {B}
            \have {31} {\perp} \ne{25, 30}
          \close
          \have {32} {\perp} \oe{27, 28-29, 30-31}
        \close
        \have {33} {\lnot (A \lor B)} \ne{26-32}
      \close
      \have {39} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \ii{26-33}
    \close
    \have {40} {(\lnot A \land \lnot B) \limplies \lnot (A \lor B)} \oe{1, 3-17, 18-39}
  \close
\end{ndresume}
$

\paragraph{Soundness of natural deductions.}
Idea behind the soundness is also simple. We just explain that every line of
the proof represent a tautology, including the last one. We illustrate this on
the exaple of the proof of $A \lor \lnot A$. Recall that the proof of this
tautology is the following.

\noindent $
  \begin{nd}
    \hypo {1} {}
    \open
      \hypo {2} {\lnot (A \lor \lnot A)}
      \open
        \hypo {3} {A}
        \have {4} {A \lor \lnot A}
        \have {5} {\perp}
      \close
      \have {6} {\lnot A}
      \have {7} {A \lor \lnot A}
      \have {8} {\perp}
    \close
    \have {9} {A \lor \lnot A}
  \end{nd}
$

\begin{enumerate}
  \item The second line is just an assumption, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies \lnot (A \lor \lnot A)$.
  \item Line~3 is also an assumption so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies (A \limplies A)$.
  \item Line~4 is a formula $A \lor \lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$ and $A$, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies (A \limplies (A \lor \lnot A))$ (it is a
    tautology since we replaced $A$ by $A \lor \lnot A$ in the conclusion of
    the formula corresponding to Line~3).
  \item Line~5 is a formula $\perp$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$ and $A$, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies (A \limplies \perp)$ (it is a
    tautology since on Line~4 we explained that $\lnot (A \lor \lnot A)
    \limplies (A \limplies (A \lor \lnot A))$).
  \item Line~6 is a formula $\lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies \lnot A$ (it is a
    tautology since on Line~5 we explained that $A \limplies \perp$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Line~7 is a formula $A \lor \lnot A$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies (A \lor \lnot A)$ (it is a
    tautology since on Line~6 we explained that $A$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Line~8 is a formula $\perp$ which we derived under assumptions
    $\lnot (A \lor \lnot A)$, so the corresponding tautology is
    $\lnot (A \lor \lnot A) \limplies \perp$ (it is a
    tautology since on Line~6 we explained that $A \lor \lnot A$ under the
    assumption $\lnot (A \lor \lnot A)$).
  \item Finally, Line~9 is a formula $A \lor \lnot A$ (it is a tautology since
    we proved that $\lnot (A \lor \lnot A) \limplies \perp$ is a tautology)
\end{enumerate}



\begin{chapterendexercises}
  \exercise % CAREFUL, DONT MOVE! THERE IS A REFERENCE TO THIS NUMBER
    Let $\phi_1$ and $\phi_2$ be some propositional formulas on
    the variables from $V$. Show that for any propositional assignement
    $\rho$ to $V$,
    \begin{itemize}
      \item
        $\substitute{
        \lnot\left(
          \phi_1 \land \phi_2
        \right)}{\rho} =
        \substitute{
          \left(
            \lnot \phi_1 \lor \lnot \phi_2
          \right)
         }{\rho}$ and
    \item
    $\substitute{
    \lnot\left(
      \phi_1 \lor \phi_2
    \right)}{\rho} =
    \substitute{
      \left(
        \lnot \phi_1 \land \lnot \phi_2
      \right)
     }{\rho}$.
  \end{itemize}
  \exercise % CAREFUL, DONT MOVE! THERE IS A REFERENCE TO THIS NUMBER
    Let $\phi_1$, \dots, $\phi_n$ be some propositional formulas on
    the variables from $V$. Show that for any propositional assignement
    $\rho$ to $V$,
    \begin{itemize}
      \item
        $\substitute{
          \left(
            \lnot \left(
                    \bigland_{i = 1}^n \phi_i
                  \right)
          \right)}{\rho} =
          \substitute{
            \left(
              \biglor_{i = 1}^n \phi_i
            \right)
           }{\rho}$ and
      \item
        $\substitute{
         \left(
           \lnot \left(
                   \biglor_{i = 1}^n \phi_i
                 \right)
         \right)}{\rho} =
         \substitute{
           \left(
             \bigland_{i = 1}^n \phi_i
           \right)
          }{\rho}$.
    \end{itemize}
  \exercise  Write a natural deduction derivation of $A \lor C$ from
    hypothesis $(A \land B) \lor C$.
  \exercise Write a natural deduction derivation of $B \lor C$ from
    hypothesis $A \limplies B$ and $\lnot A \limplies C$.
  \exercise Write a natural deduction derivation of
    $(W \lor Y) \limplies (X \lor Z)$ from
    hypotheses $W \limplies X$ and $Y \limplies Z$.
  \exercise Let us formulate the pigeonhole principle using propositional
    formulas. Let
    $V = \set{x_{1, 1}, \dots, x_{n + 1, 1}, x_{1, 2} \dots, x_{n + 1, n}}$
    (informally $x_{i, j}$ is true iff the $i$th pigeon is in the $j$th hole).
    Consider the following propositional formulas on the variables from
    $V$.
    \begin{itemize}
      \item $L_i$ ($i \in [n + 1]$) is equal to $\bigvee_{j = 1}^n x_{i, j}$.
        (Informally this formula says that the $i$th pigeon is in a hole.)
      \item $R_j$ ($j \in [n]$) is equal to
        $\biglor_{i_1 = 1}^{n + 1} \biglor_{i_2 = i_1 + 1}^{n + 1}
        (x_{i_1, j} \land x_{i_2, j})$.
        (Informally this formula says that there are two pigeons in the $j$th
        hole.)
      \end{itemize}

      Show that there is a natural deduction derivation of
      $\left(
          \bigland_{i = 1}^{n + 1} L_i
        \right)
        \limplies
        \left(
          \biglor_{i = 1}^{n} R_i
        \right)$.
    \exercise Let $\phi = \bigvee_{i = 1}^m \lambda_i$ be a clause; we say that
      the width of the clause is equal to $m$.
      Let $\phi = \bigwedge_{i = 1}^\ell \chi_i$ be a formula in CNF
      ($\chi_i$'s are clauses'); we say that the width of $\phi$ is equal to
      the maximal width of $\chi_i$ for $i \in \range{\ell}$.

      Let $p_n : \set{\ltrue, \lfalse}^n \to \set{\ltrue, \lfalse}$ such that
      $p_n(x_1, \dots, x_n) = \ltrue$
      iff the set $\set[x_i = \ltrue]{i}$ has an odd number of elements.
      Show that any CNF representation of $p_n$ has width $n$.
    \exercise In this exercise we think about clauses as sets of literals so
      the order of disjunctions and repetitions of literals are not important.
      We say that a clause $C$ can be obtained from clauses $A$ and $B$
      using the \emph{resolution} rule if $C = A^\prime \lor B^\prime$,
      $A = x \lor A^\prime$, and $B = \lnot x \lor B^\prime$, for some variable
      $x$.

      We say that a clause $C$ can be derived from clauses $A_1$, \dots, $A_m$
      using resolutions
      if there is a sequence of clauses $D_1$, \dots, $D_\ell = C$ such that
      each $D_i$
      \begin{itemize}
        \item is either obtained from clauses $D_j$ and $D_k$ for $j, k < i$ using the
          \emph{resolution} rule, or
        \item is equal to $A_j$ for some $j \in [m]$, or
        \item is equal to $D_j \lor E$ for some $j < i$ and a clause $E$.
      \end{itemize}

      Show that if an empty clause $\perp$ can be derived from clauses $A_1$, \dots, $A_m$ using the resolution rule, then $A_1$, \dots, $A_m$ semantically imply $\perp$.
\end{chapterendexercises}
