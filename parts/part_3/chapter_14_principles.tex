\chapter{Counting Principles}
\label{chapter:principles}
\marginurl{%
  Counting Principles:\\\noindent
  Introduction to Combinatorics \#2
}{youtu.be/dAoperLCjb8}
\section{The Additive Principle}
The first principle is called \emph{additive} principle and it states that if
you have two disjoint sets, then their union have size equal to the sum of their
sizes.

A simple illustration of this statement is the following. Assume you have three
pencils and two pens; how many ways to choose a writing accessory. According to
this principle the answer is $2 + 3 = 5$.
\begin{theorem}[The Additive Principle]
\label{theorem:additive-principle}
  Let $X$ and $Y$ be finite sets. If $X \cap Y = \emptyset$, then $|X \cup Y| =
  |X| + |Y|$.
\end{theorem}
\begin{proof}
  Let $|X| = n$, $|Y| = m$ and $g : \range{n} \to X$ and $h : \range{m} \to Y$ be
  bijections. In order to prove it we just construct a bijection
  $f : [n + m] \to (X \cup Y)$.

  \[
    f(i) =
    \begin{cases}
        g(i) & i < n \\
        h(i  - n) & i > n
    \end{cases}.
  \]

  It's easy to see that $f$ is an injection. Let us start by assuming the opposite i.e.
  that $i_0 \neq i_1 \in X \cup Y$ such that $f(i_0) = f(i_1)$.
  There are three cases.
  \begin{itemize}
    \item The first is when $i_0, i_1 \in \range{n}$. In this case $g(i_0) = g(i_1)$
      which contradicts the assumption that $g$ is a bijection.
    \item The second is when $i_0, i_1 \in \set{n + 1, n + 2, \dots, m}$.
      In this case $h(i_0 - n) = h(i_1 - n)$ which contradicts the assumption
      that $h$ is a bijection.
    \item Finally, the last case is when $i_0 \in \range{n}$ and
      $i_1 \in \set{n + 1, n + 2, \dots, m}$. It is easy to see that this
      implies that $g(i_0) = h(i_1 - n)$. However, it
      means that $g(i_0) = h(i_1 - n) \in (X \cap Y)$, which contradicts the
      assumption that $X \cap Y = \emptyset$.
  \end{itemize}

  To finish the proof we need to show that $f$ is a surjection. Let
  $w \in (X \cup Y)$. Consider the following two cases.
  \begin{itemize}
    \item Let $w \in X$. There is $i \in \range{n}$ such that $f(i) = g(i) = w$ since
      $g$ is a bijection.
    \item Otherwise, $w \in Y$. In this case, there is $i \in \range{m}$ such that
      $f(i + n) = h(i) = w$ since $h$ is a bijection.
  \end{itemize}
\end{proof}

\begin{corollary}
\label{corollary:additive-principle}
  Let $X_1, \dots, X_n$ be some pairwise disjoint sets. Then
  $\left|\bigcup_{i = 1}^n X_i\right| = \sum_{i = 1}^n |X_i|$.
\end{corollary}

\begin{exercise}
  Prove Corollary~\ref{corollary:additive-principle}.
\end{exercise}


\section{The Multiplicative Principle}
The next principle is called the \emph{multiplicative} principle and it can be
illustrated as follows: imagine that you are given two postal stamps and
three envelopes, how many ways are there to pack the letters? The answer is obviously
$2 \cdot 3 = 6$.
\begin{theorem}[The Multiplicative Principle]
  Let $X$ and $Y$ be finite sets. Then $|X \times Y| = |X| \times |Y|$.
\end{theorem}
\begin{proof}
  If one of the sets $X$ and $Y$ is empty, then $X \times Y$ is empty as well
  and the statement is as follows.

  Assume that none of the sets are empty. Let $|X| = n$, $|Y| = m$, and
  $f : \range{n} \to X$ and $g : \range{m} \to Y$ be bijections.
  Note that
  \[
    \bigcup_{i = 1}^n (\set{f(i)} \times Y) = X \times Y.
  \]
  Additionally, note that $(\set{f(i)} \times Y) \cap (\set{f(j)} \times Y) =
  \emptyset$ for $i \neq j$. Finally, it is easy to see that $g_i : \range{m} \to
  (\set{f(i)} \times Y)$ such that $g_i(j) = (f(i), g(j))$ is a bijection.
  Hence,
  $|X \times Y| = \sum_{i = 1}^n |\set{f(i)} \times Y| = n \cdot m$.
\end{proof}

\begin{exercise}
  Find the cardinality of the set
  \[
    \set[{x, y \in [9] \text{ and } x \neq y}]{(x, y)}.
  \]
\end{exercise}

By analogy with unions and intersections of many sets we can define the cross
product of many sets.
Let $X_1$, \dots, $X_n$ be some sets. Then $\bigtimes_{i = 1}^1 X_i = A_1$ and
$\bigtimes_{i = 1}^{k + 1} X_i =
  \left(\bigtimes_{i = 1}^k X_i\right) \times X_{k + 1}$\footnote{%
    Note that cross product is not associative and different definitions of the
    product of several sets are not equivalent. However, the bijection
    constructed in the previous section allow us to think about these
    definitions as if they are equivalent.
}.

\begin{corollary}
\label{corollary:multiplicative-principle}
  Let $X_1, \dots, X_n$ be some finite sets. Then
  $\left|\bigtimes_{i = 1}^n X_i\right| = \prod_{i = 1}^n |X_i|$.
\end{corollary}

\begin{exercise}
  Prove Corollary~\ref{corollary:multiplicative-principle}.
\end{exercise}

\begin{theorem}
\label{theorem:cardinality-of-power-set}
  For any set $X$, $|2^X| = 2^{|X|}$.
\end{theorem}
\begin{proof}
  By Corollary~\ref{corollary:power-set-and-set-of-binary-strings}, $|2^X| =
  \left|\set{0, 1}^{|X|}\right|$, so it is enough to prove that
  $|\set{0, 1}^{|X|}| = 2^{|X|}$. This statement is true by
  Corollary~\ref{corollary:multiplicative-principle} since $|\set{0, 1}^{|X|}| =
  \prod_{i = 1}^{|X|} |\set{0, 1}| = 2^{|X|}$.
\end{proof}

\section{The Inclusion-exclusion Principle}

The last principle we are going to discuss in this chapter is the
inclusion-exclusion principle which helps us to find the size of the union
of sets when they are not disjoint.
\begin{theorem}[The Inclusion-exclusion Principle]
\label{theorem:inclusion-exclusion-principle}
  Let $X$ and $Y$ be finite sets. Then $|X \cup Y| = |X| + |Y| - |X \cap Y|$.
\end{theorem}
\begin{proof}
  Note that $X \cup Y = (X \setminus Y) \cup (Y \setminus X) \cup (X \cap Y)$.
  Hence, $|X \cup Y| = |X \setminus Y| + |Y \setminus X| + |X \cap Y|$. But it
  is possible to note that $|Y \setminus X| + |X \cap Y| = |Y|$ and
  $|X \setminus Y| + |X \cap Y| = |X|$.
\end{proof}

\begin{corollary}
\label{corollary:inclusion-exclusion-principle}
  Let $X_1, \dots, X_n$ be some finite sets. Then
  \[
    \left|\bigcup_{i = 1}^n X_i\right| =
    \sum_{S \subseteq \range{n} ~:~ S \neq \emptyset} (-1)^{|S| + 1}
      \left|\bigcap_{i \in S} X_i\right|.
  \]
\end{corollary}
\begin{proof}
  As always, we prove this statement using induction by $n$. The base case for
  $n = 2$ is true by Theorem~\ref{theorem:inclusion-exclusion-principle}.

  By the induction hypothesis,
  \[
    \left|\bigcup_{i = 1}^k X_i\right| =
    \sum_{S \subseteq \range{k} ~:~ S \neq \emptyset} (-1)^{|S| + 1}
      \left|\bigcap_{i \in S} X_i\right|.
  \]
  In addition, by Theorem~\ref{theorem:inclusion-exclusion-principle},
  \[
    \left|\bigcup_{i = 1}^{k + 1} X_i\right| =
    \left|\bigcup_{i = 1}^k X_i\right| + |X_{k + 1}| -
      \left|\left(\bigcup_{i = 1}^k X_i\right) \cap X_{k + 1}\right|.
  \]
  We need to simplify two elements of the sum on the right of the equality.
  By the induction hypothesis,
  \[
    \left|\bigcup_{i = 1}^k X_i\right| =
      \sum_{S \subseteq \range{k} ~:~ S \neq \emptyset}
        (-1)^{|S| + 1}
        \left|
          \bigcap_{i \in S} X_i
        \right|.
  \]
  In addition, it is easy to note that
  \[
    \left|\left(\bigcup_{i = 1}^k X_i\right) \cap X_{k + 1}\right| =
    \left|\bigcup_{i = 1}^k \left(X_i \cap X_{k + 1}\right)\right|.
  \]
  Thus using the induction hypothesis,
  \begin{multline*}
    \left|\left(\bigcup_{i = 1}^k X_i\right) \cap X_{k + 1}\right| = \\
    \sum_{S \subseteq \range{k} ~:~ S \neq \emptyset}
          (-1)^{|S| + 1}
          \left|
            \bigcap_{i \in S} (X_i \cap X_{k + 1})
          \right| = \\
    \sum_{S \subseteq [k + 1] ~:~ (k + 1) \in S \text{ and } S \neq \set{k + 1}}
          (-1)^{|S|} \left|\bigcap_{i \in S} X_i \right|.
  \end{multline*}
  As a result,
  \[
    |X_{k + 1}| -
      \left|\left(\bigcup_{i = 1}^k X_i\right) \cap X_{k + 1}\right| =
    \sum_{S \subseteq [k + 1] ~:~ (k + 1) \in S}
          (-1)^{|S| + 1} \left|\bigcap_{i \in S} X_i \right|.
  \]
  Which implies that
  \begin{multline*}
    \left|\bigcup_{i = 1}^{k + 1} X_i\right| =
    \sum_{S \subseteq \range{k} ~:~ S \neq \emptyset}
      (-1)^{|S| + 1}
      \left|
        \bigcap_{i \in S} X_i
      \right| + \\
    \sum_{S \subseteq [k + 1] ~:~ (k + 1) \in S}
          (-1)^{|S| + 1} \left|\bigcap_{i \in S} X_i \right| = \\
    \sum_{S \subseteq [k + 1] ~:~ S \neq \emptyset}
      (-1)^{|S| + 1}
      \left|
        \bigcap_{i \in S} X_i
      \right|.
  \end{multline*}
\end{proof}



\begin{chapterendexercises}
  \exercise[recommended] How many numbers from $[999]$ are not divisible neither by $3$,
    nor by $5$, nor by $7$.
  \exercise How many numbers $x$ from $1$ to $999$ such that at least one
    of the digits of $x$ is $7$?
  \exercise Let $A, B$ be some finite sets such that $A \subseteq B$.
    Show that $|B \setminus A| = |B| - |A|$.
  \exercise[recommended] Let $n$ be some positive integer.
    Find the cardinality of the set
    \[
      \set[{A, B \subseteq \range{n} \text{ and } A \cap B \neq \emptyset}]{(A, B)}?
    \]
  \exercise Let $X$ and $Y$ be some finite sets, and $f : X \to Y$ be a function
    such that $|f^{-1}(y)| = k$ for all $y \in Y$. Prove that $|X| = k|Y|$.
  \exercise[recommended] Show that if $U$ and $X_1, \dots, X_n \subseteq U$ are
    some finite sets, then
    \[
      \left| \bigcap_{i = 1}^n X_i \right| =
      \sum_{S \subseteq \range{n}} (-1)^{|S|}
        \left| \bigcap_{i \in S} \overline{X}_i \right|,
    \]
    where $\overline{X}_i = U \setminus X_i$ and
    $\bigcap_{i \in \emptyset} \overline{X}_i = U$.
\end{chapterendexercises}
